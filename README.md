# 🌟 注音符號學習樂園

專為失語症患者與學齡前兒童設計的注音符號學習 App

## ✨ 功能特色

### 第0關：基礎認識
- 37個注音符號（21個聲母 + 16個韻母）
- 點擊播放真人發音
- 學習進度追蹤（localStorage）
- 已掌握符號標記

### 第一關：射擊挑戰
- 語音辨識互動（Web Speech API）
- 大聲唸出注音符號
- 即時發音辨識與回饋
- 錯誤時顯示嘴型提示
- 鼓勵語音提示

### 第二關：圖片識字
- 8大分類：家人、動物、水果、日常用品、食物、動作、身體、自然
- 共 80+ 個詞彙
- emoji 圖示 + 中文 + 注音
- TTS 語音播放
- 語音辨識複誦
- 學習進度追蹤
- 里程碑成就系統

### 第三關：句子與閱讀 ✨ NEW
- 11 種遊戲模式，大師級挑戰
- **看圖說話**：看情境圖片，練習說出簡單句子
- **句子填空**：選擇正確詞彙填入空格
- **詞彙排序**：將打亂的詞彙排成正確句子
- **聽句選圖**：聽句子描述，選出對應情境圖
- **故事接龍**：看圖說故事，描述連續事件
- **問答練習**：練習回答「這是什麼？」等問題
- **生活對話**：模擬生活情境，練習實用對話
- **朗讀練習**：簡單短文朗讀，語音即時回饋
- **數字練習**：學習數字 0-99 的發音
- **競賽模式**：賽車衝刺、寶物獵人

---

## 📱 PWA 支援

本 App 支援 PWA（Progressive Web App），可以：

- **iOS/iPad**：Safari 開啟 → 點「分享」→「加入主畫面」
- **Android**：Chrome 開啟 → 點選單 →「加到主畫面」
- **電腦**：Chrome 網址列右側有安裝按鈕

### 離線使用
安裝後可離線使用，所有音檔和頁面都會快取到裝置上。

---

## 🔊 音檔來源

- 來源：教育部《國語注音符號手冊》
- 授權：創用CC 姓名標示 4.0 國際版本
- 格式：MP3（檔案大小從 5.2MB 減少到 324KB）

---

## 📁 專案結構

```
zhuyin-learning/
├── index.html          # 主頁（選關畫面）
├── manifest.json       # PWA 設定檔
├── sw.js               # Service Worker（離線快取）
├── level0/
│   └── index.html      # 第0關：基礎認識
├── level1/
│   ├── index.html      # 第一關：注音練習
│   └── games/          # 聽音選字、記憶配對、射擊、聲調練習等
├── level2/
│   ├── index.html      # 第二關：圖片識字
│   └── games/          # 詞彙學習、看圖選字、唸唸看等
├── level3/
│   ├── index.html      # 第三關：句子與閱讀 ✨
│   └── games/          # 看圖說話、句子填空、賽車競賽等 11 種遊戲
├── sounds/
│   └── F1~F37.mp3      # 注音發音音檔
└── icons/
    └── icon-*.png      # App 圖示（各尺寸）
```

---

## 🚀 部署方式

### GitHub Pages
1. 將專案 push 到 GitHub
2. 到 Settings → Pages → Source 選擇 main branch
3. 等待部署完成即可存取

---

## 📋 版本紀錄

作者：陳宜誠律師（Vincent Chen, Attorney at Law）及 Claude Code

### v3.6.1（2025-02-03）
- ✅ **修正 VAD 偵測邏輯**
  - 修正「偵測到聲音但辨識失敗」時的處理邏輯
  - 門檻為 0 時（失語症友善模式）：偵測到聲音就算通過
  - 門檻大於 0 時：顯示「聽到聲音了，但辨識不清楚，請再試一次！」提示重試
  - 修正的檔案：
    - Level 1: number-practice.html
    - Level 2: number-practice.html、learn-words.html、speak-word.html
    - Level 3: number-practice.html、story-chain.html、read-aloud.html、qa-practice.html、picture-talk.html、daily-dialog.html

### v3.6（2025-02-02）
- ✅ **Level 1 遊戲更新**
  - 「射擊遊戲」更名為「發聲練習」
  - 新增「老鷹抓禮物」射擊遊戲
- ✅ **所有語音辨識遊戲全面升級**（共 9 個遊戲）
  - 新增 VAD（語音活動偵測）：使用 Web Audio API 即時偵測聲音
  - 當偵測到聲音時顯示「🎤 聽到你的聲音了！」回饋
  - 聆聽時間自動調整：單字 8 秒、2-3 字 6 秒、4-6 字 8 秒、長句 10 秒
  - 提示語自動調整：單字顯示「請唸 2~3 次！」，多字顯示「請跟著唸！」
  - 鼓勵語整合使用者名稱（例如：「小明，太棒了！」）
  - 改進辨識結果處理：過濾系統語音、立即處理結果
  - 更新的檔案：
    - Level 1: number-practice.html（數字 0-9）
    - Level 2: number-practice.html（數字 0-30）、speak-word.html（唸唸看）
    - Level 3: number-practice.html（數字 0-99）、story-chain.html、read-aloud.html、qa-practice.html、picture-talk.html、daily-dialog.html
- ✅ **設定頁面「字詞庫管理」功能大幅改進**
  - 新增類別標籤切換，可瀏覽系統內建的 8 大字詞類別（家人、動物、水果、日常用品、食物、動作、身體、自然）
  - 新增例句資料庫瀏覽，包含簡單句子、問答練習、填空練習、對話練習
  - 顯示各類別的字詞數量統計
  - 點擊系統字詞可複製到自訂區進行修改
  - 保留原有的自訂字詞新增功能

### v3.5（2025-01-30）
- ✅ **修正 Safari 語音辨識相容性問題**
  - Safari 的 Web Speech API 永遠不會回傳 `isFinal: true`
  - 改在 `onend` 事件中處理 `lastTranscript`，確保結果不會遺失
  - 修正所有 11 個語音辨識遊戲
- ✅ **「我會唸」按鈕預設顯示**
  - 射擊遊戲、所有數字遊戲的「✅ 我會唸」按鈕預設顯示
  - 使用者可隨時手動確認，不必等到辨識失敗
- ✅ **遊戲流程改善：先說明再開始**
  - 聽音選數、看數唸出模式加入開始前確認對話框
  - 語音說明玩法，用戶點「確定」才開始遊戲
  - 避免遊戲自動開始造成使用者困擾
- ✅ **新增麥克風測試功能（設定頁面）**
  - 在設定頁面新增「麥克風測試」區塊
  - 可測試麥克風權限授予是否成功
  - 即時音量指示條顯示收音狀態
  - 語音辨識測試確認辨識功能正常
  - 提供詳細的錯誤訊息與解決建議

### v3.4（2025-01-30）
- ✅ **全面 UI 優化（23 個遊戲）**
  - 放大所有互動按鈕（padding 18px 32px, font-size 1.3rem, min-height 65px）
  - 放大選項按鈕/卡片（min-height 70px, font-size 1.4rem）
  - 麥克風按鈕加上明顯閃爍發光動畫（粉紫色光暈）
  - 互動按鈕加上閃爍提示，引導兒童點擊正確位置
  - 第0關/第一關：卡片大小適中，網格完整顯示

### v3.3（2025-01-30）
- ✅ **修正語音辨識 isFinal 結果遺失問題**
  - 改用 `continuous = false` 讓瀏覽器自動管理辨識週期
  - 新增 `lastTranscript` 儲存中間結果，避免結果遺失
  - 在 `onend` 補救處理未完成的辨識結果
  - 修正 9 個語音辨識遊戲（Level 1-3 全部）

### v3.2（2025-01-29）
- ✅ **修正語音辨識問題**
  - 改用 `continuous = true` 持續聆聽模式
  - 延長聆聽時間至 8 秒，給使用者足夠時間發音
  - 語音結束後額外等待 1 秒確保辨識完成
  - 更新 9 個語音辨識遊戲（Level 1-3 全部）
- ✅ **修正第0關掉落遊戲速度**
  - 降低注音符號掉落速度（原本太快，兒童來不及點擊）

### v3.1（2025-01-28）
- ✅ **新增發音相似度追蹤系統**（用於失語症復健紀錄）
  - 計算使用者發音與標準答案的相似度（Levenshtein 距離演算法）
  - 記錄每次發音練習（注音符號、字詞、數字、句子）
  - 保留最佳成績，追蹤進步情況
- ✅ **設定頁面新增功能**
  - 過關門檻滑桿（0-100%）
  - 快捷按鈕：鼓勵模式(0%)、練習模式(50%)、挑戰模式(80%)、精準模式(90%)
  - 發音紀錄檢視（統計摘要、分類統計、需加強項目、進步項目）
  - 匯出紀錄功能（JSON 格式，可作為醫療追蹤紀錄）
- ✅ **更新 9 個語音辨識遊戲**
  - 整合相似度計算與紀錄功能
  - 根據門檻設定判斷是否過關
  - 顯示即時相似度回饋

### v3.0（2025-01-20）
- ✅ **UI 全面重新設計**
  - 固定高度佈局，無需捲動
  - 使用 Flexbox 彈性配置
  - 支援 `100dvh` 動態視窗高度（解決手機瀏覽器網址列問題）
  - 橫向模式自動調整版面
- ✅ **新增聲調練習遊戲**
  - 學習模式：認識一聲、二聲、三聲、四聲、輕聲
  - 測驗模式：聽音辨識聲調
- ✅ **麥克風權限改進**
  - 新增手動啟動麥克風按鈕
  - 權限被拒時提供替代操作方式
- ✅ **第二關遊戲顯示注音符號**
- ✅ **歡迎語音時機修正**
- ✅ **第0關自動進階功能**
- ✅ 所有遊戲頁面 UI 統一優化（共 20+ 個頁面）

### v2.0.0（2025-01-14）
- ✅ **架構重整**：為失語症患者設計更漸進式的學習體驗
- ✅ 規劃更多元的小遊戲類型（開發中）
- ✅ 支援自訂家人照片（私人版本）
- ✅ 圖片資源策略：公開版本使用免費圖庫或漫畫風格

### v1.2.0（2025-01-14）
- ✅ **第二關完成！** 圖片識字功能
  - 8大分類、80+ 詞彙
  - emoji 圖示視覺學習
  - TTS 發音 + 語音辨識
  - 進度追蹤 + 成就系統

### v1.1.0（2025-01-14）
- ✅ PWA 支援（manifest.json + Service Worker）
- ✅ 音檔從 WAV 轉換為 MP3（檔案大小減少 94%）
- ✅ 新增各尺寸 App 圖示
- ✅ 支援離線使用

### v1.0.0
- 初始版本
- 第0關：基礎認識
- 第一關：射擊挑戰（語音辨識）

---

## 🛠️ 技術細節

- 純 HTML/CSS/JavaScript，無需建置工具
- Web Speech API 語音辨識
- Web Speech Synthesis API 語音合成（TTS）
- localStorage 儲存學習進度
- Service Worker 離線快取
- 響應式設計（支援手機/平板/電腦）

---

## 📝 授權

MIT License

音檔來源遵循教育部創用CC授權條款。
