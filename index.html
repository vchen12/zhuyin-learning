<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="æ³¨éŸ³å­¸ç¿’æ¨‚åœ’">
    <meta name="theme-color" content="#667eea">
    <meta name="description" content="å°ˆç‚ºå¤±èªç—‡æ‚£è€…èˆ‡å­¸é½¡å‰å…’ç«¥è¨­è¨ˆçš„æ³¨éŸ³ç¬¦è™Ÿå­¸ç¿’ App">
    <!-- PWA -->
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">
    <link rel="icon" type="image/png" sizes="32x32" href="icons/icon-96.png">
    <title>ğŸŒŸ æ³¨éŸ³ç¬¦è™Ÿå­¸ç¿’æ¨‚åœ’ ğŸŒŸ</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            padding: 20px;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
            padding: 30px 20px;
        }
        .header h1 {
            font-size: 3rem;
            text-shadow: 3px 3px 6px rgba(0,0,0,0.3);
            margin-bottom: 15px;
        }
        .header .subtitle {
            font-size: 1.3rem;
            opacity: 0.9;
        }
        .header .version {
            font-size: 0.9rem;
            opacity: 0.7;
            margin-top: 10px;
        }

        /* é€²åº¦ç¸½è¦½ */
        .progress-overview {
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 20px;
            margin-bottom: 30px;
        }
        .progress-overview h3 {
            color: white;
            text-align: center;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        .progress-stats {
            display: flex;
            justify-content: center;
            gap: 40px;
            flex-wrap: wrap;
        }
        .progress-stat {
            text-align: center;
            color: white;
        }
        .progress-stat .value {
            font-size: 2rem;
            font-weight: bold;
        }
        .progress-stat .label {
            font-size: 0.85rem;
            opacity: 0.8;
        }

        .levels {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            margin-bottom: 40px;
        }
        .level-card {
            background: white;
            border-radius: 25px;
            padding: 35px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            transition: transform 0.3s, box-shadow 0.3s;
            cursor: pointer;
            text-decoration: none;
            color: inherit;
            display: block;
            position: relative;
            overflow: hidden;
        }
        .level-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        .level-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 5px;
        }
        .level-card.level0::before { background: linear-gradient(90deg, #4caf50, #8bc34a); }
        .level-card.level1::before { background: linear-gradient(90deg, #667eea, #764ba2); }
        .level-card.level2::before { background: linear-gradient(90deg, #11998e, #38ef7d); }
        .level-card.level3::before { background: linear-gradient(90deg, #f093fb, #f5576c); }

        .level-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }
        .level-title {
            font-size: 1.5rem;
            color: #333;
            margin-bottom: 10px;
            font-weight: bold;
        }
        .level-desc {
            color: #666;
            font-size: 1rem;
            margin-bottom: 15px;
            line-height: 1.5;
        }
        .level-badge {
            display: inline-block;
            padding: 6px 18px;
            border-radius: 20px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .badge-beginner { background: #e8f5e9; color: #4caf50; }
        .badge-intermediate { background: #e3f2fd; color: #2196f3; }
        .badge-advanced { background: #fff3e0; color: #ff9800; }
        .badge-master { background: #fce4ec; color: #e91e63; }

        .game-count {
            margin-top: 12px;
            font-size: 0.85rem;
            color: #999;
        }
        .game-count span {
            background: #f0f0f0;
            padding: 3px 10px;
            border-radius: 10px;
        }

        /* æ¨™ç±¤ */
        .tag {
            position: absolute;
            top: 12px;
            right: 12px;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.7rem;
            font-weight: bold;
            color: white;
        }
        .tag-new { background: linear-gradient(135deg, #f093fb, #f5576c); }
        .tag-wip { background: #ff9800; }

        .footer {
            text-align: center;
            color: white;
            padding: 25px;
            opacity: 0.8;
        }
        .footer a {
            color: white;
            text-decoration: underline;
        }

        @media (max-width: 768px) {
            .header h1 { font-size: 2.2rem; }
            .level-icon { font-size: 3.5rem; }
            .level-title { font-size: 1.3rem; }
            .progress-stat .value { font-size: 1.6rem; }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸŒŸ æ³¨éŸ³ç¬¦è™Ÿå­¸ç¿’æ¨‚åœ’ ğŸŒŸ</h1>
            <div class="subtitle">å°ˆç‚ºå¤±èªç—‡æ‚£è€…èˆ‡å­¸é½¡å‰å…’ç«¥è¨­è¨ˆ</div>
            <div class="version">ä½œè€…ï¼šé™³å®œèª å¾‹å¸«ï¼ˆVincent Chenï¼‰åŠ Claude Code | v3.4</div>
        </div>

        <!-- é€²åº¦ç¸½è¦½ -->
        <div class="progress-overview">
            <h3>ğŸ“Š å­¸ç¿’é€²åº¦</h3>
            <div class="progress-stats">
                <div class="progress-stat">
                    <div class="value" id="zhuyinCount">0/37</div>
                    <div class="label">æ³¨éŸ³ç¬¦è™Ÿ</div>
                </div>
                <div class="progress-stat">
                    <div class="value" id="wordsCount">0</div>
                    <div class="label">è©å½™</div>
                </div>
                <div class="progress-stat">
                    <div class="value">24</div>
                    <div class="label">å°éŠæˆ²</div>
                </div>
            </div>
        </div>

        <div class="levels">
            <!-- ç¬¬0é—œ -->
            <a href="level0/index.html" class="level-card level0">
                <div class="level-icon">ğŸ“–</div>
                <div class="level-title">ç¬¬0é—œï¼šåŸºç¤èªè­˜</div>
                <div class="level-desc">
                    ç†Ÿæ‚‰37å€‹æ³¨éŸ³ç¬¦è™Ÿ<br>
                    è½ç™¼éŸ³ã€è·Ÿè‘—å”¸<br>
                    å»ºç«‹åŸºç¤èªçŸ¥
                </div>
                <span class="level-badge badge-beginner">å…¥é–€ç´š</span>
                <div class="game-count">éŠæˆ²æ•¸ï¼š<span>1</span></div>
            </a>

            <!-- ç¬¬ä¸€é—œ -->
            <a href="level1/index.html" class="level-card level1">
                <span class="tag tag-new">âœ¨ NEW</span>
                <div class="level-icon">ğŸ¯</div>
                <div class="level-title">ç¬¬ä¸€é—œï¼šæ³¨éŸ³ç¬¦è™ŸåŸºç¤</div>
                <div class="level-desc">
                    è½éŸ³é¸å­—ã€é…å°ç¿»ç‰Œ<br>
                    å°„æ“ŠæŒ‘æˆ°ï¼ˆèªéŸ³è¾¨è­˜ï¼‰<br>
                    è¨“ç·´ç¬¦è™Ÿè¾¨è­˜èƒ½åŠ›
                </div>
                <span class="level-badge badge-intermediate">é€²éšç´š</span>
                <div class="game-count">éŠæˆ²æ•¸ï¼š<span>5</span></div>
            </a>

            <!-- ç¬¬äºŒé—œ -->
            <a href="level2/index.html" class="level-card level2">
                <span class="tag tag-new">âœ¨ NEW</span>
                <div class="level-icon">ğŸ–¼ï¸</div>
                <div class="level-title">ç¬¬äºŒé—œï¼šåœ–ç‰‡è­˜å­—</div>
                <div class="level-desc">
                    çœ‹åœ–å­¸è©ã€è½éŸ³é¸åœ–<br>
                    åœ–æ–‡é…å°ã€è¨˜æ†¶ç¿»ç‰Œ<br>
                    å¯¦ç”¨è©å½™å­¸ç¿’
                </div>
                <span class="level-badge badge-advanced">å¯¦æˆ°ç´š</span>
                <div class="game-count">éŠæˆ²æ•¸ï¼š<span>7</span></div>
            </a>

            <!-- ç¬¬ä¸‰é—œ -->
            <a href="level3/index.html" class="level-card level3">
                <span class="tag tag-new">âœ¨ NEW</span>
                <div class="level-icon">ğŸ“</div>
                <div class="level-title">ç¬¬ä¸‰é—œï¼šå¥å­èˆ‡é–±è®€</div>
                <div class="level-desc">
                    çœ‹åœ–èªªè©±ã€å¥å­å¡«ç©º<br>
                    è³½è»Šè¡åˆºã€å¯¶ç‰©çµäºº<br>
                    é€²éšè¡¨é”è¨“ç·´
                </div>
                <span class="level-badge badge-master">å¤§å¸«ç´š</span>
                <div class="game-count">éŠæˆ²æ•¸ï¼š<span>11</span></div>
            </a>
        </div>

        <!-- è¨­å®šæŒ‰éˆ• -->
            <a href="settings.html" class="level-card" style="background: linear-gradient(135deg, #9e9e9e 0%, #757575 100%); max-width: 300px; margin: 0 auto;">
                <div class="level-icon" style="font-size: 3rem;">âš™ï¸</div>
                <div class="level-title" style="color: white;">å€‹äººåŒ–è¨­å®š</div>
                <div class="level-desc" style="color: rgba(255,255,255,0.9);">
                    è‡ªè¨‚è§’è‰²åç¨±<br>ä¸Šå‚³å®¶äººç…§ç‰‡
                </div>
            </a>
        </div>

        <div class="footer">
            <p>éŸ³æª”ä¾†æºï¼šæ•™è‚²éƒ¨ã€Šåœ‹èªæ³¨éŸ³ç¬¦è™Ÿæ‰‹å†Šã€‹</p>
            <p style="margin-top: 10px;">æˆæ¬Šï¼šå‰µç”¨CC å§“åæ¨™ç¤º 4.0 åœ‹éš›ç‰ˆæœ¬</p>
            <p style="margin-top: 15px; font-size: 0.9rem;">
                å»ºè­°ä½¿ç”¨ Chrome ç€è¦½å™¨ä»¥ç²å¾—æœ€ä½³é«”é©—<br>
                iPadç”¨æˆ¶ï¼šè«‹é»ã€Œåˆ†äº«ã€â†’ã€ŒåŠ å…¥ä¸»ç•«é¢ã€
            </p>
        </div>
    </div>

    <script>
        // è¼‰å…¥é€²åº¦
        function loadProgress() {
            const masteredZhuyin = JSON.parse(localStorage.getItem('masteredZhuyin') || '[]');
            document.getElementById('zhuyinCount').textContent = masteredZhuyin.length + '/37';

            const masteredWords = JSON.parse(localStorage.getItem('masteredWords_level2') || '{}');
            let wordsTotal = 0;
            for (const cat of Object.keys(masteredWords)) {
                wordsTotal += Object.keys(masteredWords[cat]).length;
            }
            document.getElementById('wordsCount').textContent = wordsTotal;
        }

        loadProgress();

        // èªéŸ³åˆæˆèªªè©±åŠŸèƒ½
        let voicesReady = false;
        function speak(text, callback) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'zh-TW';
                utterance.rate = 0.85;
                utterance.pitch = 1.1;
                if (callback) {
                    utterance.onend = callback;
                }
                window.speechSynthesis.speak(utterance);
            }
        }

        // é å…ˆè¼‰å…¥èªéŸ³å¼•æ“
        function initVoices() {
            if ('speechSynthesis' in window) {
                // å¼·åˆ¶åˆå§‹åŒ–èªéŸ³å¼•æ“
                window.speechSynthesis.getVoices();
                window.speechSynthesis.onvoiceschanged = () => {
                    voicesReady = true;
                };
                // æŸäº›ç€è¦½å™¨ä¸æœƒè§¸ç™¼ onvoiceschanged
                setTimeout(() => { voicesReady = true; }, 500);
            }
        }

        // æ­¡è¿èªéŸ³å¼•å°
        let hasPlayedWelcome = false;
        function welcomeGuide() {
            if (hasPlayedWelcome) return;
            hasPlayedWelcome = true;
            // æ¨™è¨˜å·²æ’­æ”¾é¦–é æ­¡è¿èªï¼Œé€²å…¥é—œå¡å¾Œä¸å†é‡è¤‡æ’­æ”¾
            sessionStorage.setItem('welcomePlayed', 'true');
            // ç¢ºä¿èªéŸ³å¼•æ“å·²å°±ç·’
            setTimeout(() => {
                speak('æ­¡è¿ä¾†åˆ°æ³¨éŸ³ç¬¦è™Ÿå­¸ç¿’æ¨‚åœ’ï¼è«‹é¸æ“‡ä¸€å€‹é—œå¡é–‹å§‹å­¸ç¿’ã€‚', () => {
                    setTimeout(() => {
                        speak('å»ºè­°å¾ç¬¬é›¶é—œé–‹å§‹ï¼Œç†Ÿæ‚‰æ³¨éŸ³ç¬¦è™Ÿï¼');
                    }, 800);
                });
            }, 500);
        }

        // åˆå§‹åŒ–èªéŸ³å¼•æ“
        initVoices();

        // æ‰€æœ‰ç€è¦½å™¨éƒ½éœ€è¦ç”¨æˆ¶äº’å‹•æ‰èƒ½æ’­æ”¾èªéŸ³
        document.addEventListener('touchstart', welcomeGuide, { once: true });
        document.addEventListener('click', welcomeGuide, { once: true });

        // è¨»å†Š Service Worker
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('/sw.js')
                    .then(reg => console.log('SW è¨»å†ŠæˆåŠŸ:', reg.scope))
                    .catch(err => console.log('SW è¨»å†Šå¤±æ•—:', err));
            });
        }

        // ==========================================
        // é˜²æ­¢é é¢ç¸®æ”¾å’Œé¸å–ï¼ˆé©åˆå…’ç«¥æ“ä½œï¼‰
        // ==========================================

        // é˜²æ­¢é›™æŒ‡ç¸®æ”¾
        document.addEventListener('gesturestart', function(e) {
            e.preventDefault();
        }, { passive: false });

        document.addEventListener('gesturechange', function(e) {
            e.preventDefault();
        }, { passive: false });

        document.addEventListener('gestureend', function(e) {
            e.preventDefault();
        }, { passive: false });

        // é˜²æ­¢é›™æ“Šç¸®æ”¾
        let lastTouchEnd = 0;
        document.addEventListener('touchend', function(event) {
            const now = Date.now();
            if (now - lastTouchEnd <= 300) {
                event.preventDefault();
            }
            lastTouchEnd = now;
        }, { passive: false });

        // é˜²æ­¢è§¸æ§ç§»å‹•æ™‚ç¸®æ”¾ï¼ˆåœ¨éæ»¾å‹•å€åŸŸï¼‰
        document.addEventListener('touchmove', function(e) {
            if (e.touches.length > 1) {
                e.preventDefault();
            }
        }, { passive: false });

        // é˜²æ­¢æ»‘é¼ æ»¾è¼ªç¸®æ”¾ï¼ˆCtrl+æ»¾è¼ªï¼‰
        document.addEventListener('wheel', function(e) {
            if (e.ctrlKey) {
                e.preventDefault();
            }
        }, { passive: false });

        // é˜²æ­¢éµç›¤ç¸®æ”¾ï¼ˆCtrl + +/-/0ï¼‰
        document.addEventListener('keydown', function(e) {
            if ((e.ctrlKey || e.metaKey) && (e.key === '+' || e.key === '-' || e.key === '=' || e.key === '0')) {
                e.preventDefault();
            }
        });

        // é˜²æ­¢æ–‡å­—é¸å–ï¼ˆé¿å…å…’ç«¥èª¤è§¸é€²å…¥é¸å–æ¨¡å¼ï¼‰
        document.addEventListener('selectstart', function(e) {
            // åªåœ¨éè¼¸å…¥å…ƒç´ ä¸Šé˜²æ­¢é¸å–
            if (e.target.tagName !== 'INPUT' && e.target.tagName !== 'TEXTAREA') {
                e.preventDefault();
            }
        });

        // é˜²æ­¢é•·æŒ‰å½ˆå‡ºé¸å–®
        document.addEventListener('contextmenu', function(e) {
            e.preventDefault();
        });
    </script>
</body>
</html>
