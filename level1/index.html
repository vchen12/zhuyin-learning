<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="theme-color" content="#667eea">
    <link rel="manifest" href="../manifest.json">
    <link rel="apple-touch-icon" href="../icons/apple-touch-icon.png">
    <title>ğŸ¯ ç¬¬ä¸€é—œï¼šæ³¨éŸ³ç¬¦è™ŸåŸºç¤</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body {
            min-height: 100vh;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            font-family: 'Microsoft JhengHei', 'PingFang TC', sans-serif;
            padding: 20px;
        }

        /* å°èˆªåˆ— */
        .nav-bar {
            background: rgba(255,255,255,0.95);
            padding: 15px 20px;
            border-radius: 15px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .back-btn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 20px;
            font-size: 1rem;
            cursor: pointer;
            text-decoration: none;
        }
        .nav-title {
            font-size: 1.3rem;
            color: #667eea;
            font-weight: bold;
        }
        .progress-info {
            font-size: 1rem;
            color: #764ba2;
        }

        /* æ¨™é¡Œ */
        .page-title {
            text-align: center;
            color: white;
            margin-bottom: 40px;
        }
        .page-title h1 {
            font-size: 2.5rem;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
            margin-bottom: 10px;
        }
        .page-title p {
            font-size: 1.2rem;
            opacity: 0.9;
        }

        /* éŠæˆ²é¸å–® */
        .games-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 25px;
            max-width: 900px;
            margin: 0 auto;
        }

        .game-card {
            background: white;
            border-radius: 25px;
            padding: 35px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
            cursor: pointer;
            transition: transform 0.3s, box-shadow 0.3s;
            text-decoration: none;
            color: inherit;
            display: block;
        }
        .game-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        }
        .game-card:active {
            transform: scale(0.98);
        }

        .game-icon {
            font-size: 4rem;
            margin-bottom: 15px;
        }
        .game-name {
            font-size: 1.6rem;
            color: #667eea;
            font-weight: bold;
            margin-bottom: 10px;
        }
        .game-desc {
            color: #666;
            font-size: 1rem;
            line-height: 1.5;
            margin-bottom: 15px;
        }
        .game-badge {
            display: inline-block;
            padding: 6px 16px;
            border-radius: 15px;
            font-size: 0.85rem;
            font-weight: bold;
        }
        .badge-easy {
            background: #e8f5e9;
            color: #4caf50;
        }
        .badge-medium {
            background: #fff3e0;
            color: #ff9800;
        }

        /* é€²åº¦å€ */
        .progress-section {
            background: rgba(255,255,255,0.15);
            border-radius: 20px;
            padding: 25px;
            margin-top: 40px;
            max-width: 900px;
            margin-left: auto;
            margin-right: auto;
            text-align: center;
        }
        .progress-section h3 {
            color: white;
            font-size: 1.3rem;
            margin-bottom: 15px;
        }
        .progress-bar-container {
            background: rgba(255,255,255,0.3);
            height: 20px;
            border-radius: 10px;
            overflow: hidden;
            margin-bottom: 10px;
        }
        .progress-bar-fill {
            height: 100%;
            background: linear-gradient(90deg, #4caf50, #8bc34a);
            transition: width 0.5s;
            border-radius: 10px;
        }
        .progress-text {
            color: white;
            font-size: 1.1rem;
        }

        @media (max-width: 768px) {
            .page-title h1 { font-size: 2rem; }
            .game-icon { font-size: 3rem; }
            .game-name { font-size: 1.3rem; }
        }
    </style>
</head>
<body>
    <nav class="nav-bar">
        <a href="../index.html" class="back-btn">â† è¿”å›é¦–é </a>
        <div class="nav-title">ç¬¬ä¸€é—œ</div>
        <div class="progress-info">å·²æŒæ¡ï¼š<span id="masteredCount">0</span>/37</div>
    </nav>

    <div class="page-title">
        <h1>ğŸ¯ æ³¨éŸ³ç¬¦è™ŸåŸºç¤</h1>
        <p>èªè­˜ 37 å€‹æ³¨éŸ³ç¬¦è™Ÿçš„ã€Œå½¢ã€èˆ‡ã€ŒéŸ³ã€</p>
    </div>

    <div class="games-grid">
        <!-- éŠæˆ² 1-1ï¼šè½éŸ³é¸å­— -->
        <a href="games/listen-choose.html" class="game-card">
            <div class="game-icon">ğŸ‘‚</div>
            <div class="game-name">è½éŸ³é¸å­—</div>
            <div class="game-desc">
                è½æ³¨éŸ³ç™¼éŸ³<br>
                å¾å››å€‹é¸é …ä¸­é¸å‡ºæ­£ç¢ºçš„ç¬¦è™Ÿ
            </div>
            <span class="game-badge badge-easy">å…¥é–€</span>
        </a>

        <!-- éŠæˆ² 1-2ï¼šé…å°ç¿»ç‰Œ -->
        <a href="games/memory-match.html" class="game-card">
            <div class="game-icon">ğŸƒ</div>
            <div class="game-name">é…å°ç¿»ç‰Œ</div>
            <div class="game-desc">
                ç¿»é–‹å¡ç‰‡æ‰¾å‡ºé…å°<br>
                è¨“ç·´æ³¨éŸ³ç¬¦è™Ÿè¨˜æ†¶åŠ›
            </div>
            <span class="game-badge badge-easy">å…¥é–€</span>
        </a>

        <!-- éŠæˆ² 1-3ï¼šå°„æ“ŠæŒ‘æˆ° -->
        <a href="games/shooting.html" class="game-card">
            <div class="game-icon">ğŸ¤</div>
            <div class="game-name">å°„æ“ŠæŒ‘æˆ°</div>
            <div class="game-desc">
                è½ç™¼éŸ³å¾Œå¤§è²å”¸å‡ºä¾†<br>
                èªéŸ³è¾¨è­˜å³æ™‚å›é¥‹
            </div>
            <span class="game-badge badge-medium">é€²éš</span>
        </a>

        <!-- éŠæˆ² 1-4ï¼šæ•¸å­—ç·´ç¿’ -->
        <a href="games/number-practice.html" class="game-card">
            <div class="game-icon">ğŸ”¢</div>
            <div class="game-name">æ•¸å­—ç·´ç¿’</div>
            <div class="game-desc">
                å­¸ç¿’æ•¸å­— 0-9 çš„ç™¼éŸ³<br>
                è½éŸ³é¸æ•¸ã€çœ‹æ•¸å”¸å‡º
            </div>
            <span class="game-badge badge-easy">å…¥é–€</span>
        </a>

        <!-- éŠæˆ² 1-5ï¼šè²èª¿ç·´ç¿’ -->
        <a href="games/tone-practice.html" class="game-card">
            <div class="game-icon">ğŸµ</div>
            <div class="game-name">è²èª¿ç·´ç¿’</div>
            <div class="game-desc">
                èªè­˜ä¸€äºŒä¸‰å››è²å’Œè¼•è²<br>
                å­¸ç¿’è²èª¿çš„ç™¼éŸ³è¦å‰‡
            </div>
            <span class="game-badge badge-medium">é€²éš</span>
        </a>
    </div>

    <div class="progress-section">
        <h3>ğŸ“Š å­¸ç¿’é€²åº¦</h3>
        <div class="progress-bar-container">
            <div class="progress-bar-fill" id="progressBar" style="width: 0%"></div>
        </div>
        <div class="progress-text">
            è²æ¯ï¼š<span id="initialsCount">0</span>/21 |
            éŸ»æ¯ï¼š<span id="finalsCount">0</span>/16
        </div>
    </div>

    <script>
        // èªéŸ³åˆæˆèªªè©±åŠŸèƒ½
        function speak(text, callback) {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.cancel();
                const utterance = new SpeechSynthesisUtterance(text);
                utterance.lang = 'zh-TW';
                utterance.rate = 0.85;
                utterance.pitch = 1.1;
                if (callback) {
                    utterance.onend = callback;
                }
                window.speechSynthesis.speak(utterance);
            }
        }

        // é å…ˆè¼‰å…¥èªéŸ³å¼•æ“
        function initVoices() {
            if ('speechSynthesis' in window) {
                window.speechSynthesis.getVoices();
                window.speechSynthesis.onvoiceschanged = () => {};
            }
        }

        // æ­¡è¿èªéŸ³å¼•å°
        let hasPlayedWelcome = false;
        function welcomeGuide() {
            if (hasPlayedWelcome) return;
            hasPlayedWelcome = true;

            // å¦‚æœå·²ç¶“åœ¨é¦–é æ’­æ”¾éæ­¡è¿èªï¼Œåªæ’­æ”¾ç°¡çŸ­æç¤º
            const welcomePlayed = sessionStorage.getItem('welcomePlayed');
            setTimeout(() => {
                if (welcomePlayed) {
                    speak('ç¬¬ä¸€é—œï¼Œæ³¨éŸ³ç¬¦è™ŸåŸºç¤ï¼è«‹é¸æ“‡ä¸€å€‹éŠæˆ²ã€‚');
                } else {
                    speak('æ­¡è¿ä¾†åˆ°ç¬¬ä¸€é—œï¼Œæ³¨éŸ³ç¬¦è™ŸåŸºç¤ï¼é€™è£¡æœ‰å››å€‹éŠæˆ²å¹«åŠ©ä½ èªè­˜æ³¨éŸ³ã€‚è«‹é¸æ“‡ä¸€å€‹éŠæˆ²é–‹å§‹å§ï¼', () => {
                        setTimeout(() => {
                            speak('å»ºè­°å¾ã€Œè½éŸ³é¸å­—ã€é–‹å§‹ï¼Œè¨“ç·´ä½ çš„è€³æœµï¼');
                        }, 800);
                    });
                }
            }, 500);
        }

        // è¼‰å…¥é€²åº¦
        function loadProgress() {
            const mastered = JSON.parse(localStorage.getItem('masteredZhuyin') || '[]');
            const initialsAll = ['ã„…','ã„†','ã„‡','ã„ˆ','ã„‰','ã„Š','ã„‹','ã„Œ','ã„','ã„','ã„','ã„','ã„‘','ã„’','ã„“','ã„”','ã„•','ã„–','ã„—','ã„˜','ã„™'];
            const finalsAll = ['ã„š','ã„›','ã„œ','ã„','ã„','ã„Ÿ','ã„ ','ã„¡','ã„¢','ã„£','ã„¤','ã„¥','ã„¦','ã„§','ã„¨','ã„©'];

            const initialsCount = mastered.filter(s => initialsAll.includes(s)).length;
            const finalsCount = mastered.filter(s => finalsAll.includes(s)).length;
            const total = mastered.length;

            document.getElementById('masteredCount').textContent = total;
            document.getElementById('initialsCount').textContent = initialsCount;
            document.getElementById('finalsCount').textContent = finalsCount;
            document.getElementById('progressBar').style.width = Math.round((total / 37) * 100) + '%';
        }

        loadProgress();
        initVoices();
        // æ‰€æœ‰ç€è¦½å™¨éƒ½éœ€è¦ç”¨æˆ¶äº’å‹•æ‰èƒ½æ’­æ”¾èªéŸ³
        document.addEventListener('touchstart', welcomeGuide, { once: true });
        document.addEventListener('click', welcomeGuide, { once: true });
    </script>
</body>
</html>
